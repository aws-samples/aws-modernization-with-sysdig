---
title: "4.2. EKS Runtime threat detection"
chapter: true
weight: 2
---

Sysdig Secure uses Falco under the hood to deliver Runtime Security
for Linux, containers and Kubernetes.

Hence, all the benefits of the Open Source Ecosystem are available
when protecting workloads in runtime.

In this module you will learn how to detect and respond to
runtime security threats.


## Enable Runtime Security policies

1. Visit your Sysdig Secure account to and check that all the 
   `Kubernetes Audit` and `Runtime (Workload)` policies are enabled.
   If not, enable them in the [**Secure > Runtime Policies** dashboard](https://secure.sysdig.com/#/policies?policyTypes=k8s_audit%2Cfalco).

2. Access the policy `select one policy in particular, don't enable for all of them!!!`  with the edit button and Enable (Actions> captures). This will be used for Forensics.


## Trigger a security event

To trigger security events in your EKS cluster, the [falco event generator](https://github.com/falcosecurity/event-generator) will be used.

1. Go back to your terminal and execute the next command:
   
    ```
    kubectl create ns event-generator
    helm upgrade --install event-generator falcosecurity/event-generator \
        --namespace event-generator \
        --create-namespace \
        --set config.command=test \
        --set config.actions=""
    ```

    The activity of this workload will generate activity in the cluster that might be an indicator of a compromised environment.
    In the next section, you will learn how to investigate the incident in Sysdig Secure.


## Events

![Events](/images/events.png)

The Events dashboard in Sysdig Secure provides the main entry point to review suspicious activity in your environment.
Events are the result of rules in a policy being triggered, hence they can be generated by syscall activity, but also from cloud events (previous sub-module).

Each event includes a rich context with information from Cloud, Kubernetes and Host information,
to help you identify what happened and where.

From the event, you can dig deeper to:
- learn more about the policy that triggered the event.
- generate a Network Security Policy to isolate the workload.
- Observer activity in Activity audit to correlate event activity with other network, filesystem and commands activity in the system.
- Jump to a system capture in Sysdig Inspect to do forensics and learn more about environments gone long ago.
- Launch a Rapid Response Shell into the host to apply further forensics or put the host in quarantine.


## Sysdig Secure Activity Audit

![Activity Audit](/images/activity-audit.png)

The Activity Audit menu allows you to apply further forensics to understand an incident.

Click on the previous detected event and go to its details. Here, click **View Activity Audit**. Here you'll find a time based event feed with all the related activity of the security event. All the related Kubernetes activity is included with the rest of the information.


## Sysdig Inspect

Depending on the policy that triggers an event, the event can include a Capture of system activity before and after the security incident.
The Sysdig Agent generates a capture file with all the syscall activity in the environment when an incident occures.
This feature allows you to investigate the attack even long after a container is gone.

In the previous step, you configured a Policy to generate a capture when the rule `XXXXXXXX` weas detected.

1. Browse to the Captures section and open the capture to preview it in Sysdig Inspect
  (alternatively, go to the event, click on Respond and then `View Capture in Inspect`).

2. Drill down into `Executed Interactive Commands`.
   Here you can find the sequence of commands executed during the attack.
   This panel can provide information about network connections, executed commands or files created/edited.
   You can even preview the content of files modified.


    ![Capture](/images/capture.png)

3. Go back to the main Inspect dashboard and
   filter and dig deeper to observe other areas from the syscall activity of the security incident.
