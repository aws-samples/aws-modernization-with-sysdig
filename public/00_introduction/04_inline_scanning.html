<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.71.0" />
    <meta name="description" content="AWS Modernization Workshop with Sysdig">
<meta name="author" content="Sysdig Training and CNATIVE Teams">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Image Scanning Technical Description :: Secure DevOps with AWS &amp; Sysdig</title>

    
    <link href="/css/nucleus.css?1612547437" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1612547437" rel="stylesheet">
    <link href="/css/hybrid.css?1612547437" rel="stylesheet">
    <link href="/css/featherlight.min.css?1612547437" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1612547437" rel="stylesheet">
    <link href="/css/auto-complete.css?1612547437" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1612547437" rel="stylesheet">
    <link href="/css/theme.css?1612547437" rel="stylesheet">
    <link href="/css/hugo-theme.css?1612547437" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1612547437" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1612547437"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/00_introduction/04_inline_scanning.html">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a href="/" title="Go home"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 30" width="60%" style="padding:20px 0px;"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg></a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1612547437"></script>
<script type="text/javascript" src="/js/auto-complete.js?1612547437"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1612547437"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/00_introduction.html" title="Introduction" class="dd-item 
        parent
        
        
        ">
      <a href="/00_introduction.html">
          Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/00_introduction/03_image_scanning.html" title="Image Scanning Overview" class="dd-item ">
        <a href="/00_introduction/03_image_scanning.html">
        Image Scanning Overview
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/00_introduction/04_inline_scanning.html" title="Image Scanning Technical Description" class="dd-item active">
        <a href="/00_introduction/04_inline_scanning.html">
        Image Scanning Technical Description
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/00_introduction/05_fargate_ecs_sec.html" title="AWS Fargate and ECS Security" class="dd-item ">
        <a href="/00_introduction/05_fargate_ecs_sec.html">
        AWS Fargate and ECS Security
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/00_introduction/06_infra_runtime_sec.html" title="Infrastructure Runtime Security" class="dd-item ">
        <a href="/00_introduction/06_infra_runtime_sec.html">
        Infrastructure Runtime Security
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/10_prerequisites.html" title="Prerequisites" class="dd-item 
        
        
        
        ">
      <a href="/10_prerequisites.html">
          Prerequisites
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/12_sysdig.html" title="1. Sign-up for a Sysdig Trial account" class="dd-item ">
        <a href="/10_prerequisites/12_sysdig.html">
        1. Sign-up for a Sysdig Trial account
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/14_aws_event_setup.html" title="2. Attending an AWS hosted event" class="dd-item ">
        <a href="/10_prerequisites/14_aws_event_setup.html">
        2. Attending an AWS hosted event
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/16_aws_setup_your_own.html" title="3. Running the workshop on your own" class="dd-item ">
        <a href="/10_prerequisites/16_aws_setup_your_own.html">
        3. Running the workshop on your own
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/18_start_cloud9workspace.html" title="4.1 Create a Workspace" class="dd-item ">
        <a href="/10_prerequisites/18_start_cloud9workspace.html">
        4.1 Create a Workspace
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/20_create_iam_role.html" title="4.2 Create IAM role" class="dd-item ">
        <a href="/10_prerequisites/20_create_iam_role.html">
        4.2 Create IAM role
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/22_attach_iam_role.html" title="4.3 Attach IAM Role" class="dd-item ">
        <a href="/10_prerequisites/22_attach_iam_role.html">
        4.3 Attach IAM Role
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/24_config_workshop_req.html" title="4.4 Configure workshop specific requirements" class="dd-item ">
        <a href="/10_prerequisites/24_config_workshop_req.html">
        4.4 Configure workshop specific requirements
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/30_module_1.html" title="1. ECR Automated Image Scanning" class="dd-item 
        
        
        
        ">
      <a href="/30_module_1.html">
          1. ECR Automated Image Scanning
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/30_module_1/30_setup_ecr.html" title="Setup Amazon ECR Registry" class="dd-item ">
        <a href="/30_module_1/30_setup_ecr.html">
        Setup Amazon ECR Registry
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/30_module_1/31_deploy_ecr_integration.html" title="Deploy the Amazon ECR Integration" class="dd-item ">
        <a href="/30_module_1/31_deploy_ecr_integration.html">
        Deploy the Amazon ECR Integration
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/30_module_1/32_image_from_registry.html" title="Push and Scan an Image from the Registry" class="dd-item ">
        <a href="/30_module_1/32_image_from_registry.html">
        Push and Scan an Image from the Registry
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/30_module_1/33_image_rescan.html" title="Modify the image and trigger a second scan" class="dd-item ">
        <a href="/30_module_1/33_image_rescan.html">
        Modify the image and trigger a second scan
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/30_module_1/34_review.html" title="Module Review" class="dd-item ">
        <a href="/30_module_1/34_review.html">
        Module Review
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/30_module_1/35_cleanup.html" title="Cleanup" class="dd-item ">
        <a href="/30_module_1/35_cleanup.html">
        Cleanup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/40_module_2.html" title="2. Fargate &amp; ECS Automated Image Scanning" class="dd-item 
        
        
        
        ">
      <a href="/40_module_2.html">
          2. Fargate &amp; ECS Automated Image Scanning
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/40_module_2/40_install_amazon_ecs_cli.html" title="Install Amazon ECS CLI" class="dd-item ">
        <a href="/40_module_2/40_install_amazon_ecs_cli.html">
        Install Amazon ECS CLI
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/40_module_2/41_deploy_image_scanner_for_fargate.html" title="Deploy Sysdig Secure Automated Image Scanner for Fargate" class="dd-item ">
        <a href="/40_module_2/41_deploy_image_scanner_for_fargate.html">
        Deploy Sysdig Secure Automated Image Scanner for Fargate
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/40_module_2/42_deploy_an_ecs_cluster.html" title="Deploy an ECS cluster using Fargate" class="dd-item ">
        <a href="/40_module_2/42_deploy_an_ecs_cluster.html">
        Deploy an ECS cluster using Fargate
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/40_module_2/43_initiate_scan.html" title="Initiate CodeBuild Pipelines Build and Scan" class="dd-item ">
        <a href="/40_module_2/43_initiate_scan.html">
        Initiate CodeBuild Pipelines Build and Scan
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/40_module_2/44_sysdig_secure_dashboard.html" title="View Results on Sysdig Secure Dashboard" class="dd-item ">
        <a href="/40_module_2/44_sysdig_secure_dashboard.html">
        View Results on Sysdig Secure Dashboard
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/40_module_2/45_review.html" title="Module Review" class="dd-item ">
        <a href="/40_module_2/45_review.html">
        Module Review
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/40_module_2/46_cleanup.html" title="Cleanup" class="dd-item ">
        <a href="/40_module_2/46_cleanup.html">
        Cleanup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/50_module_3.html" title="3. CloudTrail Runtime Security" class="dd-item 
        
        
        
        ">
      <a href="/50_module_3.html">
          3. CloudTrail Runtime Security
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/50_module_3/50_prework.html" title="Prework" class="dd-item ">
        <a href="/50_module_3/50_prework.html">
        Prework
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/50_module_3/51_enable_aws_security_hub.html" title="Installing the CloudConnector" class="dd-item ">
        <a href="/50_module_3/51_enable_aws_security_hub.html">
        Installing the CloudConnector
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/50_module_3/51_setup_cloudtrail_runtime_security.html" title="Setup CloudTrail Runtime Security" class="dd-item ">
        <a href="/50_module_3/51_setup_cloudtrail_runtime_security.html">
        Setup CloudTrail Runtime Security
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/50_module_3/52_detecting_runtime_cloud_security_threats.html" title="Detecting Runtime Cloud Security Threats" class="dd-item ">
        <a href="/50_module_3/52_detecting_runtime_cloud_security_threats.html">
        Detecting Runtime Cloud Security Threats
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/50_module_3/53_checking_security_findings_in_the_aws_security_hub.html" title="Checking Security Findings in AWS Security Hub" class="dd-item ">
        <a href="/50_module_3/53_checking_security_findings_in_the_aws_security_hub.html">
        Checking Security Findings in AWS Security Hub
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/50_module_3/54_modifying_a_falco_rule_for_cloudtrail.html" title="Modifying a Falco Rule for CloudTrail" class="dd-item ">
        <a href="/50_module_3/54_modifying_a_falco_rule_for_cloudtrail.html">
        Modifying a Falco Rule for CloudTrail
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/50_module_3/55_review.html" title="Module Review" class="dd-item ">
        <a href="/50_module_3/55_review.html">
        Module Review
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/50_module_3/56_cleanup.html" title="Cleanup" class="dd-item ">
        <a href="/50_module_3/56_cleanup.html">
        Cleanup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/60_conclusions.html" title="Conclusions" class="dd-item 
        
        
        
        ">
      <a href="/60_conclusions.html">
          Conclusions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/70_cleanup.html" title="Cleanup" class="dd-item 
        
        
        
        ">
      <a href="/70_cleanup.html">
          Cleanup
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://awsworkshop.io"><i class='fas fa-graduation-cap'></i> Modernization Workshops</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://aws.amazon.com/builders-library/"><i class='fas fa-tools'></i> AWS Builders Library</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://aws.amazon.com/blogs/modernizing-with-aws/"><i class='far fa-lightbulb'></i> Modernization with AWS</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://aws.amazon.com/marketplace/seller-profile?id=649de783-b546-4795-8891-8002dbaf19b8"><i class='far fa-lightbulb'></i> Sysdig on AWS Marketplace</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://sysdig.com/company/free-trial/"><i class='far fa-lightbulb'></i> Signup for Sysdig Trial Account</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    <h5 class="copyright">&copy; 2020 Amazon Web Services, Inc. or its Affiliates. All rights reserved.<h5>
</left>


    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/sysdiglabs/aws-modernization-workshop-with-Sysdig/edit/main/content/00_introduction/04_inline_scanning.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Main Page</a> > <a href='/00_introduction.html'>Introduction</a> > Image Scanning Technical Description
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#phase-1-analysis-of-contents">Phase 1 - Analysis of Contents</a>
<ul>
<li><a href="#going-a-little-deeper">Going A Little Deeper&hellip;</a></li>
</ul></li>
<li><a href="#phase-2-evaluation">Phase 2 - Evaluation</a></li>
</ul></li>
<li><a href="#inline-scanning-vs-backend-scanning">Inline Scanning vs Backend Scanning</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Image Scanning Technical Description
            </h1>
          

        





<p>There are two general approaches to scanning images in Sysdig - backend scanning or inline scanning.  The reasons why you might choose one over the other is best explained by an understanding of how scanning works under the hood.</p>

<!-- <img src=/images/00_introduction/inline_scanning01.png width="50%" height="50%"> -->

<!-- ## Scanning Under the Hood -->

<p>With Sysdig, there are two phases in scanning an image</p>

<ol>
<li>Analysis of contents</li>
<li>Evaluation against policies and vulnerabilities</li>
</ol>

<h3 id="phase-1-analysis-of-contents">Phase 1 - Analysis of Contents</h3>

<p>During the analysis phase of the scan, the worker first loads the image.  Each image is built upon a series of other images, called &lsquo;layers&rsquo;, each one referred to by specific SHA value in the manifest file.  Each layer is pulled down, they are then “flattened”, and the composition of all layers is analysed and a complete list of all the files, packages, package versions, etc across all the layers is generated.</p>

<p>This phase of the scan is quite process-heavy and accounts for approximately 90% of the Time/CPU consumed during the entire scan, and the output of this is a JSON document containing metadata on all aspects of the image.</p>

<p>During an inline scan, this phase happens in the image&rsquo;s environment - in a CI/CD pipeline, by an Admission Controller, or even on a Kubernetes worker node, as illustrated below.</p>

<h4 id="going-a-little-deeper">Going A Little Deeper&hellip;</h4>

<p>The scanner process uses the Anchore engine and runs between 15 and 20 different analysers, each performing different functions.  Some of these analysers create a bill of materials for the image (operating system and non-operating system packages), while others retrieve file contents, file sizes, search for secrets, open ports, etc.  Each analyser generates a JSON report containing metadata, all of which are then combined.</p>

<p>To give you a better idea of how this looks, below is a sample of the data generated in the analysis phase.</p>

<!-- <details>
<summary>Expand here to view some some sample output to give you some visualisation of how this looks
</summary> -->
<pre><code>{
  &#34;document&#34;: [
    {
      &#34;image&#34;: {
        &#34;imageId&#34;: &#34;f35646e83998b844c3f067e5a2cff84cdf0967627031aeda3042d78996b68d35&#34;,
        &#34;imagedata&#34;: {
          &#34;analysis_report&#34;: {
            &#34;analyzer_meta&#34;: {
              &#34;analyzer_meta&#34;: {
                &#34;base&#34;: {
                  &#34;DISTRO&#34;: &#34;debian&#34;,
                  &#34;DISTROVERS&#34;: &#34;10&#34;,
                  &#34;LIKEDISTRO&#34;: &#34;debian&#34;
                }
              }
            },
            &#34;file_checksums&#34;: {
              &#34;files.md5sums&#34;: {
                &#34;base&#34;: {
                  &#34;/bin&#34;: &#34;DIRECTORY_OR_OTHER&#34;,
                  &#34;/bin/bash&#34;: &#34;4600132e6a7ae0d451566943a9e79736&#34;,
                  &#34;/bin/cat&#34;: &#34;44b8726219e0d2929e9150210bfbb544&#34;,
                  &#34;/bin/chgrp&#34;: &#34;2befb2d66eee50af3fd5eb0b30102841&#34;,
                  &#34;/bin/chmod&#34;: &#34;737ae4345da6e93c44fe9b11b12defe1&#34;,
                  &#34;/bin/chown&#34;: &#34;8680c8e619194af847c009a97fd4ebe2&#34;,
                  &#34;/bin/cp&#34;: &#34;d38d5be99452fb23cce11fc7756c1594&#34;,
                  &#34;/bin/dash&#34;: &#34;895aea5b87d9d6cbd73537a9b2d45cff&#34;,
                  &#34;/bin/date&#34;: &#34;b175b76c42bf04d764f3f5d7e4f3c69c&#34;,
                  &#34;/bin/dd&#34;: &#34;1f90de0a1b75febeda1936a1ed9e1066&#34;,
                  &#34;/bin/df&#34;: &#34;b50d93d2ab75977d129baf0078becb96&#34;,
                  &#34;/bin/dir&#34;: &#34;3c76bcda677ed3ff9901d6e770ebca3d&#34;,
                  &#34;/bin/dmesg&#34;: &#34;ea95ebcd2794014a5f933f7b6434e31c&#34;,
...</code></pre>
<!-- </details> -->

<p>You can see each binary, file etc is specifically referenced with a md5 hash next to each entry which relates to its version etc.</p>

<p>The results of this analysis are combined into a single JSON analysis report, or metadata document, and it is this metadata document that is used to evaluate the scan against the defines security policy.</p>

<p>For a backend scan, this process all happens within Sysdig, however during an &lsquo;inline scan&rsquo;, this metadata is then forwarded to the Sysdig Backend for evaluation using the API - this is the reason you must supply the <strong>Sysdig Secure API Token</strong> later in this workshop!</p>

<h3 id="phase-2-evaluation">Phase 2 - Evaluation</h3>

<p>Once the Sysdig Backend retrieves the metadata it is checked against the assigned policy definitions as well as the vulnerability database.  A Sysdig Secure policy is a combination of rules about activities an enterprise wants to detect in an environment, the actions that should be taken if the policy rule is breached, and potentially the notifications that should be sent.  These policies are configured through the Sysdig UI, and may differ from image to image.</p>

<p>Individual policy rules may relate to</p>

<ul>
<li>Open ports</li>
<li>File permissions</li>
<li>Exposed passwords</li>
<li>etc</li>
</ul>

<p>A number of policies are delivered out-of-the-box and can be used as-is, duplicated, or edited as needed. These relate specifically to &lsquo;PCI&rsquo; and &lsquo;NIST 800-190&rsquo; compliance, as well as general Dockerfile best practices.  You can also create policies from scratch, using either predefined rules or creating custom rules.</p>

<h2 id="inline-scanning-vs-backend-scanning">Inline Scanning vs Backend Scanning</h2>

<p>With Backend Scanning, both phases of the scan, i.e. the analysis of contents followed by the evaluation against policies and vulnerabilities, are performed on Sysdig&rsquo;s servers.  This requires that images be transferred to Sysdig to be scanned and evaluated, therefore Sysdig must store your repository&rsquo;s credentials in order to have access to it. This may be problematic in a secure environment and/or when you&rsquo;re using SaaS.</p>

<p><img src="/images/00_introduction/backend_scanning02.png" alt="Backend Scanning" /></p>

<p>However, with Inline Scanning the scan and subsequent analysis occur where the image resides, maybe as part of a CI/CD pipeline, or within your cloud environment, for example with ECR. In this case Sysdig does not need access to your repository and only the metadata is sent back to the Sysdig backend, hence no registry keys are exposed to Sysdig.</p>

<p><img src="/images/00_introduction/inline_scanning03.png" alt="Inline Scanning" /></p>

<p>Inline Scanning is considered best practice and the better approach to scanning over backend scanning.  The benefits of scanning inline include</p>

<ul>
<li>Images don&rsquo;t leave their own environment</li>
<li>SaaS users don&rsquo;t send images and proprietary code to Sysdig&rsquo;s SaaS service</li>
<li>Registries don&rsquo;t have to be exposed</li>
<li>Images can be scanned in parallel more easily</li>
<li>Images can be scanned before they hit the registry, which can cut down on registry costs and simplify the build pipeline</li>
<li>Existing scan metadata can be checked against new vulnerabilities, so images do no need to be rescanned, for example upon detection of zero-day vulnerabilities</li>
</ul>


<footer class="footline">
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/00_introduction/03_image_scanning.html" title="Image Scanning Overview"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/00_introduction/05_fargate_ecs_sec.html" title="AWS Fargate and ECS Security" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1612547437"></script>
    <script src="/js/perfect-scrollbar.min.js?1612547437"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1612547437"></script>
    <script src="/js/jquery.sticky.js?1612547437"></script>
    <script src="/js/featherlight.min.js?1612547437"></script>
    <script src="/js/highlight.pack.js?1612547437"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1612547437"></script>
    <script src="/js/learn.js?1612547437"></script>
    <script src="/js/hugo-learn.js?1612547437"></script>

    <link href="/mermaid/mermaid.css?1612547437" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1612547437"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

